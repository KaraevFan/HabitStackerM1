# Habit Stacker V0.3 â€” Feedback & Implementation Plan

**Date:** 2026-01-25  
**Context:** Feedback on confirmation screen + habit design system integration

---

## Executive Summary

The current confirmation screen is functional but doesn't land the "wow" moment. It reads like a receipt, not a commitment. This document covers:

1. **Confirmation screen redesign** â€” Simpler, more emotionally resonant
2. **Habit design flow** â€” When and how users customize their system (Atomic Habits integration)
3. **"Your System" detail view** â€” Full UI specification

**Key decision:** Habit design (environment priming, tiny versions, friction reduction) happens *after first rep completion*, not during initial setup. Users must upload photo evidence of their first rep to unlock the tune-up conversation.

---

## Part 1: Confirmation Screen Redesign

### Current Problems

| Issue | Impact |
|-------|--------|
| Visual hierarchy is flat | Everything has equal weight; habit doesn't feel like the hero |
| Too many boxes | Four cards = visual fragmentation, feels like form output |
| Habit card is dense | Anchor â†’ Action â†’ Then with long text is hard to parse |
| "Why This Fits You" feels like justification | Four bullets = over-explanation after user already accepted |
| No emotional moment | Feels like end of a form, not start of something |
| Rating feels tacked on | Competes with CTA, feels like a survey |

### Redesigned Structure

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                             â”‚
â”‚   â† Back                                                    â”‚
â”‚                                                             â”‚
â”‚                         ğŸšƒ                                  â”‚
â”‚                                                             â”‚
â”‚              "When I board the train,                       â”‚
â”‚               I read for 5 minutes."                        â”‚
â”‚                                                             â”‚
â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€   â”‚
â”‚                                                             â”‚
â”‚   This works because you already have the perfect           â”‚
â”‚   window during your commuteâ€”and 5 minutes is small         â”‚
â”‚   enough to always win.                                     â”‚
â”‚                                                             â”‚
â”‚   If you miss: Just notice it and try tomorrow.             â”‚
â”‚                                                             â”‚
â”‚                                                             â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚           Start first rep tonight                   â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                             â”‚
â”‚                     I'll start later                        â”‚
â”‚                                                             â”‚
â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€   â”‚
â”‚                                                             â”‚
â”‚   How well did I understand you?                            â”‚
â”‚   [1] [2] [3] [4] [5]                                       â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Key Changes

1. **Hero statement** â€” The habit condensed to one memorable sentence, large and centered
2. **Visual anchor** â€” Context-appropriate emoji (ğŸšƒ train, ğŸ›ï¸ bed, â˜• coffee, etc.)
3. **Single supporting paragraph** â€” Combines "why it fits" + "if you miss" in flowing prose
4. **Rating moved below CTA** â€” Still captured, doesn't compete with commitment
5. **Removed Anchor/Action/Then labels** â€” User remembers what to do, not your framework

### Design Specifications

**Hero Statement:**
- Font: Fraunces, 24px, #1A1816
- Centered, max-width 300px
- Wrapped in quotation marks (feels like a personal mantra)
- 32px margin below emoji

**Emoji:**
- 48px size, centered
- Contextual based on habit domain:
  - Sleep: ğŸ›ï¸ or ğŸŒ™
  - Exercise: ğŸƒ or ğŸ’ª
  - Reading: ğŸ“– or ğŸšƒ
  - Finance: ğŸ’° or ğŸ“Š
  - Default: âš¡

**Supporting Text:**
- Font: Outfit, 16px, #5A5652
- Max-width 320px, centered
- Line-height 1.5
- "If you miss" on its own line, slightly lighter (#8A8680)

**Primary CTA:**
- Full-width (with 24px margins)
- Background: #2D6A5D
- Text: white, Outfit 16px semi-bold
- Border-radius: 100px
- Padding: 16px 32px
- Text includes timing hint: "Start first rep tonight" / "Start first rep now"

**Secondary CTA:**
- Text button below, #8A8680
- "I'll start later"

**Rating:**
- Below a subtle divider (1px #E8E4DC)
- Question: "How well did I understand you?"
- 5 boxes in a row, 44px touch targets
- Labels: "Not at all" (left), "Completely" (right)
- Font: Outfit 14px

---

## Part 2: Habit Design Flow

### Philosophy

The Atomic Habits-inspired customization (environment priming, tiny versions, friction reduction) is valuable, but **shouldn't clutter the initial commitment moment**. Users should:

1. Make a simple commitment first
2. Complete their first rep with evidence
3. *Then* unlock the deeper system design

This aligns with:
- Product law: "Progressive disclosureâ€”complexity appears only after evidence"
- Atomic Habits: "Standardize before you optimize"
- Building real experience before theorizing

### Proposed Flow

```
PHASE 1: COMMITMENT
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

Chat Intake (Sonnet)
    â”‚
    â–¼
Confirmation Screen (simplified)
    â”‚
    â”œâ”€â”€ Hero statement: "When I board the train, I read for 5 minutes"
    â”œâ”€â”€ Supporting paragraph (why + if you miss)
    â”œâ”€â”€ "Felt understood" rating
    â””â”€â”€ CTA: "Start first rep tonight"
    â”‚
    â–¼
User taps "Start first rep tonight"
    â”‚
    â–¼
Transition to Runtime


PHASE 2: FIRST REP WITH EVIDENCE
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

Plan Screen (Day 1+)
    â”‚
    â”œâ”€â”€ Shows habit card
    â”œâ”€â”€ "Mark today's rep" CTA
    â”‚
    â–¼
User taps "Done"
    â”‚
    â–¼
Photo Evidence Prompt
    â”‚
    â”œâ”€â”€ "Nice! Snap a quick photo as proof."
    â”œâ”€â”€ Camera button / Upload button
    â”œâ”€â”€ "Skip for now" (allowed but discouraged)
    â”‚
    â–¼
Photo uploaded (or skipped)
    â”‚
    â–¼
Celebration moment
    â”‚
    â”œâ”€â”€ "First rep complete! ğŸ‰"
    â”œâ”€â”€ Rep count updates
    â””â”€â”€ Return to Plan screen


PHASE 3: HABIT DESIGN (UNLOCKED AFTER FIRST REP)
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

Plan Screen (after 1st rep)
    â”‚
    â”œâ”€â”€ Shows habit card
    â”œâ”€â”€ Stats (1 rep, last done today)
    â”œâ”€â”€ NEW: "Tune your system" card (unlocked)
    â”‚       "You did your first rep! Let's make it stick."
    â”‚
    â–¼
User taps "Tune your system"
    â”‚
    â–¼
Habit Design Conversation (Haiku)
    â”‚
    â”œâ”€â”€ "You completed your first repâ€”nice work."
    â”œâ”€â”€ "Let's set you up so this keeps going."
    â”‚
    â”œâ”€â”€ Q1: "What almost got in the way today?"
    â”‚       â†’ Identifies friction points
    â”‚
    â”œâ”€â”€ Q2: "What could you set up the night before to make tomorrow easier?"
    â”‚       â†’ Environment priming
    â”‚
    â”œâ”€â”€ Q3: "On a really bad day, what's the tiniest version of this habit that still counts?"
    â”‚       â†’ Tiny version (2-minute rule)
    â”‚
    â””â”€â”€ Summary: "Here's your system..."
    â”‚
    â–¼
Your System Screen (populated)
    â”‚
    â”œâ”€â”€ The Ritual (anchor â†’ action â†’ then)
    â”œâ”€â”€ Your Toolkit (tiny version, environment prime, friction notes)
    â”œâ”€â”€ When You Miss (recovery)
    â””â”€â”€ Why This Works (collapsible)


PHASE 4: ONGOING
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

Plan Screen (daily)
    â”‚
    â”œâ”€â”€ Habit card with stats
    â”œâ”€â”€ "View your system" link â†’ Your System screen
    â”œâ”€â”€ Mark done/missed
    â”‚
    â–¼
If missed â†’ Recovery flow (existing)
    â”‚
    â–¼
After 7+ days â†’ Review prompt (future milestone)
```

### Photo Evidence Implementation

**Why require photos:**
- Creates real commitment (skin in the game)
- Builds evidence of identity change ("I'm someone who reads")
- Provides data for future features (habit journal, progress visualization)
- Prevents "phantom reps" (marking done without doing)

**Photo Prompt Screen:**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                             â”‚
â”‚                         ğŸ“¸                                  â”‚
â”‚                                                             â”‚
â”‚                    Nice work!                               â”‚
â”‚                                                             â”‚
â”‚         Snap a quick photo as proof of your rep.            â”‚
â”‚                                                             â”‚
â”‚         It's just for youâ€”builds your habit journal.        â”‚
â”‚                                                             â”‚
â”‚                                                             â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚              ğŸ“·  Take photo                         â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                             â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚              ğŸ–¼ï¸  Choose from library                â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                             â”‚
â”‚                     Skip for now                            â”‚
â”‚                                                             â”‚
â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€   â”‚
â”‚                                                             â”‚
â”‚   Photos are stored locally and never shared.               â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Behavior:**
- Appears after user marks rep as "Done"
- "Skip for now" is allowed but:
  - Tune-up stays locked until at least one photo is uploaded
  - Subtle encouragement: "Add a photo to unlock habit tuning"
- Photos stored locally (localStorage or IndexedDB)
- Future: photo journal view showing streak of evidence

**Data Model Addition:**

```typescript
interface RepLog {
  id: string;
  timestamp: string;
  type: 'done' | 'missed' | 'recovery';
  photoUri?: string;      // Local URI to stored photo
  photoSkipped?: boolean; // True if user explicitly skipped
  note?: string;          // Future: optional reflection
}

interface HabitData {
  // ... existing fields
  repLogs: RepLog[];
  hasCompletedFirstRepWithPhoto: boolean; // Unlocks tune-up
}
```

### Tune-Up Conversation Prompt

**Model:** Claude Haiku (cost-efficient, shorter conversation)

**System Prompt:**

```
You are a habit coach helping someone tune their habit system after completing their first rep. Your goal is to set them up for long-term consistency by identifying friction points and building support structures.

## Context
The user just completed their first rep of a habit. You'll help them:
1. Identify what almost got in the way (friction)
2. Set up their environment for success (priming)
3. Define a tiny fallback version (2-minute rule)

## Your personality
- Warm, encouraging, practical
- Briefâ€”this is a quick tune-up, not a therapy session
- Reference their specific habit and situation

## Conversation structure
1. Acknowledge their first rep (one sentence)
2. Ask about friction (what almost stopped them)
3. Ask about environment priming (what could they set up in advance)
4. Ask about tiny version (30-second fallback for bad days)
5. Summarize their system

Keep it to 4-5 turns total. Be concise.

## Output format

{
  "message": "Your response",
  "suggestedResponses": ["Option 1", "Option 2"] | null,
  "phase": "friction" | "priming" | "tiny" | "summary",
  "extractedData": {
    "frictionNotes": "string" | null,
    "environmentPrime": "string" | null,
    "tinyVersion": "string" | null
  }
}

When phase is "summary", include all extracted data formatted as their system.
```

**Example Conversation:**

```
Agent: You did your first repâ€”nice work! Before we move on, 
       quick question: what almost got in the way today?

User: I almost forgot my book

Agent: Easy fix. What could you do the night before to make 
       sure the book is ready to go?

User: Put it in my bag before bed

Agent: Perfect. Last thing: on a really bad day when everything's 
       against you, what's the tiniest version of this habit 
       that still counts? Think 30 seconds.

User: Just read one page

Agent: Got it. Here's your system:

       ğŸ“– The Ritual: Read for 5 minutes when you board the train
       
       ğŸŒ™ Night before: Put book in bag
       âš¡ Tiny version: Just read one page
       
       You're set. These small things are what make habits stick.
```

---

## Part 3: Plan Screen Updates

### Current â†’ Updated

The Plan screen needs to surface the "Tune your system" prompt after first rep.

**Before First Rep:**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                             â”‚
â”‚   YOUR HABIT                                                â”‚
â”‚                                                             â”‚
â”‚   ğŸšƒ When I board the train, I read for 5 minutes           â”‚
â”‚                                                             â”‚
â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€   â”‚
â”‚                                                             â”‚
â”‚   Reps: 0  â€¢  Last done: â€”                                  â”‚
â”‚                                                             â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚            Mark today's rep                         â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**After First Rep (Tune-Up Available):**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                             â”‚
â”‚   YOUR HABIT                                                â”‚
â”‚                                                             â”‚
â”‚   ğŸšƒ When I board the train, I read for 5 minutes           â”‚
â”‚                                                             â”‚
â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€   â”‚
â”‚                                                             â”‚
â”‚   Reps: 1  â€¢  Last done: Today                              â”‚
â”‚                                                             â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚            Mark today's rep                         â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                             â”‚
â”‚                                                             â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚  ğŸ‰ You did your first rep!                         â”‚   â”‚
â”‚   â”‚                                                     â”‚   â”‚
â”‚   â”‚  Let's set up your system so it keeps going.        â”‚   â”‚
â”‚   â”‚                                                     â”‚   â”‚
â”‚   â”‚                      Tune your system â†’             â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**After Tune-Up Complete:**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                             â”‚
â”‚   YOUR HABIT                                                â”‚
â”‚                                                             â”‚
â”‚   ğŸšƒ When I board the train, I read for 5 minutes           â”‚
â”‚                                                             â”‚
â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€   â”‚
â”‚                                                             â”‚
â”‚   Reps: 3  â€¢  Last done: Today  â€¢  View your system â†’       â”‚
â”‚                                                             â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚            Mark today's rep                         â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### State Logic

```typescript
// Determine what to show on Plan screen
function getPlanScreenState(habit: HabitData): PlanState {
  const reps = habit.repLogs.filter(r => r.type === 'done').length;
  const hasPhoto = habit.repLogs.some(r => r.photoUri);
  const hasTuned = habit.system?.tunedAt != null;
  
  if (reps === 0) {
    return 'pre_first_rep';
  }
  
  if (reps >= 1 && !hasTuned && hasPhoto) {
    return 'tune_up_available';
  }
  
  if (reps >= 1 && !hasTuned && !hasPhoto) {
    return 'needs_photo_for_tuneup';
  }
  
  if (hasTuned) {
    return 'tuned';
  }
}
```

---

## Part 4: Your System UI Specification

### Information Architecture

```
Your System
â”œâ”€â”€ 1. THE RITUAL (always visible, hero section)
â”‚   â”œâ”€â”€ Anchor (when/trigger)
â”‚   â”œâ”€â”€ Action (the habit itself)
â”‚   â””â”€â”€ Then (what happens after)
â”‚
â”œâ”€â”€ 2. YOUR TOOLKIT (populated from tune-up)
â”‚   â”œâ”€â”€ Tiny Version (30-second fallback)
â”‚   â”œâ”€â”€ Environment Prime (setup the night before)
â”‚   â””â”€â”€ Friction Notes (what makes this easier)
â”‚
â”œâ”€â”€ 3. WHEN YOU MISS (always visible)
â”‚   â””â”€â”€ Recovery action
â”‚
â””â”€â”€ 4. WHY THIS WORKS (collapsible)
    â””â”€â”€ Personalized reasoning from intake
```

### Full Layout

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                                 â”‚
â”‚  â† Back to Plan                                                 â”‚
â”‚                                                                 â”‚
â”‚  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•   â”‚
â”‚                                                                 â”‚
â”‚                        YOUR SYSTEM                              â”‚
â”‚                                                                 â”‚
â”‚  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•   â”‚
â”‚                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                                                         â”‚   â”‚
â”‚  â”‚   THE RITUAL                                            â”‚   â”‚
â”‚  â”‚                                                         â”‚   â”‚
â”‚  â”‚   â”Œâ”€â”€â”€â”                                                 â”‚   â”‚
â”‚  â”‚   â”‚ ğŸšƒâ”‚  When I board the train                        â”‚   â”‚
â”‚  â”‚   â””â”€â”€â”€â”˜                                                 â”‚   â”‚
â”‚  â”‚      â”‚                                                  â”‚   â”‚
â”‚  â”‚      â–¼                                                  â”‚   â”‚
â”‚  â”‚   â”Œâ”€â”€â”€â”                                                 â”‚   â”‚
â”‚  â”‚   â”‚ ğŸ“–â”‚  I read for 5 minutes                          â”‚   â”‚
â”‚  â”‚   â””â”€â”€â”€â”˜                                                 â”‚   â”‚
â”‚  â”‚      â”‚                                                  â”‚   â”‚
â”‚  â”‚      â–¼                                                  â”‚   â”‚
â”‚  â”‚   â”Œâ”€â”€â”€â”                                                 â”‚   â”‚
â”‚  â”‚   â”‚ âœ“ â”‚  Then I can check my phone                     â”‚   â”‚
â”‚  â”‚   â””â”€â”€â”€â”˜                                                 â”‚   â”‚
â”‚  â”‚                                                         â”‚   â”‚
â”‚  â”‚                                        Edit ritual â†’    â”‚   â”‚
â”‚  â”‚                                                         â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                 â”‚
â”‚                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                                                         â”‚   â”‚
â”‚  â”‚   YOUR TOOLKIT                                          â”‚   â”‚
â”‚  â”‚                                                         â”‚   â”‚
â”‚  â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚   â”‚
â”‚  â”‚   â”‚  âš¡ Tiny version                                 â”‚   â”‚   â”‚
â”‚  â”‚   â”‚                                                 â”‚   â”‚   â”‚
â”‚  â”‚   â”‚  "Just read one page"                           â”‚   â”‚   â”‚
â”‚  â”‚   â”‚                                                 â”‚   â”‚   â”‚
â”‚  â”‚   â”‚  For days when everything's against you.        â”‚   â”‚   â”‚
â”‚  â”‚   â”‚  Still counts. Still a rep.                     â”‚   â”‚   â”‚
â”‚  â”‚   â”‚                                         Edit â†’  â”‚   â”‚   â”‚
â”‚  â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚   â”‚
â”‚  â”‚                                                         â”‚   â”‚
â”‚  â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚   â”‚
â”‚  â”‚   â”‚  ğŸŒ™ Environment prime                           â”‚   â”‚   â”‚
â”‚  â”‚   â”‚                                                 â”‚   â”‚   â”‚
â”‚  â”‚   â”‚  "Book in bag the night before"                 â”‚   â”‚   â”‚
â”‚  â”‚   â”‚                                                 â”‚   â”‚   â”‚
â”‚  â”‚   â”‚  Set yourself up so the right choice is easy.   â”‚   â”‚   â”‚
â”‚  â”‚   â”‚                                         Edit â†’  â”‚   â”‚   â”‚
â”‚  â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚   â”‚
â”‚  â”‚                                                         â”‚   â”‚
â”‚  â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚   â”‚
â”‚  â”‚   â”‚  ğŸ”“ Friction reduced                            â”‚   â”‚   â”‚
â”‚  â”‚   â”‚                                                 â”‚   â”‚   â”‚
â”‚  â”‚   â”‚  "Downloaded audiobook for backup"              â”‚   â”‚   â”‚
â”‚  â”‚   â”‚                                                 â”‚   â”‚   â”‚
â”‚  â”‚   â”‚  Removed barriers between you and the habit.    â”‚   â”‚   â”‚
â”‚  â”‚   â”‚                                         Edit â†’  â”‚   â”‚   â”‚
â”‚  â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚   â”‚
â”‚  â”‚                                                         â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                 â”‚
â”‚                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                                                         â”‚   â”‚
â”‚  â”‚   WHEN YOU MISS                                         â”‚   â”‚
â”‚  â”‚                                                         â”‚   â”‚
â”‚  â”‚   "Just notice it happened. No guilt.                   â”‚   â”‚
â”‚  â”‚    Try again next commute."                             â”‚   â”‚
â”‚  â”‚                                                         â”‚   â”‚
â”‚  â”‚   Missing once is an accident.                          â”‚   â”‚
â”‚  â”‚   Missing twice is a new habit forming.                 â”‚   â”‚
â”‚  â”‚                                                         â”‚   â”‚
â”‚  â”‚                                         Edit â†’          â”‚   â”‚
â”‚  â”‚                                                         â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                 â”‚
â”‚                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                                                         â”‚   â”‚
â”‚  â”‚   WHY THIS WORKS FOR YOU                    â–¼ Expand    â”‚   â”‚
â”‚  â”‚                                                         â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                 â”‚
â”‚                                                                 â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
â”‚                                                                 â”‚
â”‚                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                    â”‚
â”‚                    â”‚   Re-tune your system â”‚                    â”‚
â”‚                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                    â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Component Specifications

#### Page Header
- Back link: text button, #2D6A5D, left-aligned
- Title: Fraunces, 24px, #1A1816, centered
- Subtle divider below (1px, #E8E4DC)

#### The Ritual Card (Hero)
- Card: #FFFFFF background, 1px border #E8E4DC, border-radius 12px, padding 24px
- Section label: Outfit, 11px, uppercase, letter-spacing 1.5px, #8A8680
- Icon boxes: 32x32px, border-radius 8px, background #F5F3EE
- Flow text: Outfit, 16px, #1A1816
- Connecting lines: 2px wide, #E8E4DC, 16px tall
- Edit link: Outfit, 14px, #2D6A5D, right-aligned

#### Your Toolkit Section
- Sub-cards: #FDFBF7 background, 1px border #E8E4DC, border-radius 8px, padding 16px
- Icon + label: icon 20px, label Outfit 14px semi-bold
- User content: Outfit 16px, #1A1816, in quotes
- Helper text: Outfit 14px, #8A8680
- Vertical spacing: 12px between sub-cards

**Toolkit Items:**

| Item | Icon | Helper Text |
|------|------|-------------|
| Tiny version | âš¡ | "For days when everything's against you. Still counts." |
| Environment prime | ğŸŒ™ | "Set yourself up so the right choice is easy." |
| Friction reduced | ğŸ”“ | "Removed barriers between you and the habit." |

#### When You Miss Section
- Card: #FDF8F4 background (light warm peach), 1px border #E8DDD4, border-radius 12px
- User content: Outfit 16px, #1A1816, in quotes
- Wisdom line: Outfit 14px italic, #8A8680 ("Missing once is an accident...")

#### Why This Works Section (Collapsible)
- Collapsed: single row, "â–¼ Expand" link
- Expanded: bulleted list, Outfit 15px
- Animation: 200ms ease-out height transition

#### Re-tune CTA
- Secondary style: border 1px #2D6A5D, background transparent, text #2D6A5D
- Border-radius: 100px (pill)
- Padding: 14px 32px, centered

### Edit Bottom Sheet

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                             â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  (drag handle)                          â”‚
â”‚                                                             â”‚
â”‚  Edit tiny version                                          â”‚
â”‚                                                             â”‚
â”‚  What's the smallest version of this habit that still       â”‚
â”‚  counts? Think 30 seconds or less.                          â”‚
â”‚                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚ Just read one page                                  â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚               Save                                  â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                             â”‚
â”‚  Cancel                                                     â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Part 5: Data Model Updates

```typescript
// Updated RepLog with photo support
interface RepLog {
  id: string;
  timestamp: string;
  type: 'done' | 'missed' | 'recovery';
  photoUri?: string;
  photoSkipped?: boolean;
  note?: string;
}

// Updated HabitSystem with toolkit
interface HabitSystem {
  // Core (from intake)
  anchor: string;
  action: string;
  then?: string;
  recovery: string;
  whyItFits: string[];
  
  // Toolkit (from tune-up conversation)
  tinyVersion?: string;
  environmentPrime?: string;
  frictionReduced?: string;
  
  // Metadata
  tunedAt?: string;
  tuneCount?: number;
}

// Updated HabitData
interface HabitData {
  id: string;
  state: HabitState;
  system: HabitSystem;
  repLogs: RepLog[];
  
  // Intake metadata
  intakeState?: IntakeState;
  feltUnderstoodRating?: number;
  
  // Computed helpers
  hasCompletedFirstRepWithPhoto: boolean;
}
```

---

## Part 6: Implementation Checklist

### Confirmation Screen Redesign
- [ ] Simplify to hero statement + supporting paragraph
- [ ] Add context-appropriate emoji based on habit domain
- [ ] Move "felt understood" rating below CTA
- [ ] Remove Anchor/Action/Then labels
- [ ] Condense "Why This Fits" to single paragraph

### Photo Evidence Flow
- [ ] Create PhotoPromptScreen component
- [ ] Implement camera capture (use device camera API)
- [ ] Implement photo library picker
- [ ] Store photos locally (IndexedDB or localStorage as base64)
- [ ] Add photoUri field to RepLog
- [ ] Track hasCompletedFirstRepWithPhoto flag

### Plan Screen Updates
- [ ] Add "Tune your system" card (appears after 1st rep with photo)
- [ ] Add "View your system" link (appears after tune-up)
- [ ] Implement state logic for card visibility
- [ ] Add "needs photo" nudge if skipped

### Tune-Up Conversation
- [ ] Create tune-up agent prompt (Haiku)
- [ ] Create TuneUpChat component
- [ ] Wire extracted data to HabitSystem
- [ ] Create API route for tune-up conversation

### Your System Screen
- [ ] Create YourSystemPage component
- [ ] Create RitualCard component with flow visualization
- [ ] Create ToolkitSection component
- [ ] Create MissSection component
- [ ] Create WhyItWorksSection with expand/collapse
- [ ] Create EditBottomSheet component
- [ ] Wire edits to persist in habit store

### Data Layer
- [ ] Update HabitData type with new fields
- [ ] Update RepLog type with photo fields
- [ ] Update HabitSystem type with toolkit fields
- [ ] Add migration for existing data (if any)

---

## Part 7: Test Checklist

### Confirmation Screen
- [ ] Hero statement displays habit in one sentence
- [ ] Emoji matches habit domain
- [ ] "Felt understood" rating captures and stores
- [ ] CTA text includes timing hint

### Photo Evidence
- [ ] Camera capture works on mobile
- [ ] Photo library picker works
- [ ] "Skip for now" allows completion without photo
- [ ] Photo displays in rep history (future)
- [ ] Tune-up stays locked without photo

### Tune-Up Flow
- [ ] Appears only after 1st rep with photo
- [ ] Conversation extracts all three toolkit items
- [ ] Data persists to HabitSystem
- [ ] Can re-trigger tune-up after completion

### Your System Screen
- [ ] All sections render correctly
- [ ] Edit bottom sheets work for each field
- [ ] Expand/collapse works for "Why This Works"
- [ ] Edits persist correctly
- [ ] Back navigation works

### Edge Cases
- [ ] User skips photo â†’ sees nudge, can't tune
- [ ] User completes tune-up partially â†’ partial data saved
- [ ] User re-tunes â†’ data updates correctly
- [ ] Page refresh â†’ all state preserved