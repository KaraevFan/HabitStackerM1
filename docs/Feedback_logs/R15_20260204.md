**Date:** February 4, 2026

**Source:** Daily use testing, Day 3

**Priority:** P1 — Quality of life fixes

---

## Issue 1: Conversation History Lost on Auto-Transition

### Problem

When the AI determines the reflection conversation is complete, it auto-transitions to the next screen. The conversation disappears and cannot be retrieved. User loses access to what they shared and what the AI said.

### Why It Matters

- The reflection conversation *is* the valuable data — losing it feels like losing a journal entry
- Users may want to reference what they said yesterday ("what did I log?")
- The abrupt transition removes user agency — feels like the AI decided "we're done" without asking
- Breaks the mental model of the day cards showing "what happened" if the full conversation isn't accessible

### Current Behavior

```
User sends message → AI responds → AI sets shouldClose: true → 
Screen auto-transitions → Conversation gone
```

### Proposed Fix

**Option A: User-controlled close (Recommended)**

Replace auto-transition with explicit user action:

```
User sends message → AI responds with closing message → 
"Done reflecting" button appears → User taps → 
Conversation saved → Screen transitions
```

The AI can signal it's ready to close ("See you tomorrow at 8pm") but the user commits to ending.

**Option B: Store and surface conversations**

Keep auto-transition but:

1. Store full conversation array with each CheckIn record
2. Make day cards in Journey tab expandable
3. Tap card → shows full conversation exchange, not just snippet

**Recommendation:** Do both. Option A fixes the agency problem. Option B makes history browsable.

### Implementation Notes

**For Option A:**

Modify `CheckInConversation.tsx`:

- When AI returns `shouldClose: true`, don't auto-transition
- Instead, show a "Done reflecting" or "Finish" button
- Button tap triggers save + transition
- AI's closing message stays visible until user dismisses

**For Option B:**

Modify `CheckIn` type in `src/types/habit.ts`:

```tsx
interface CheckIn {
  // existing fields...
  conversation?: ConversationMessage[];  // Full chat history
}

interface ConversationMessage {
  role: 'user' | 'assistant';
  content: string;
  timestamp: string;
}
```

Modify `DayCard.tsx`:

- Add expandable state
- When expanded, show full conversation thread
- Collapse on tap outside or explicit close

---

## Issue 2: "Finish Setup" Badge Shows When Complete

### Problem

The "Finish setup (5/5)" prompt appears on Journey and Self tabs even when setup is fully complete. Creates false impression that something is undone.

### Current Behavior

```
Setup: 5/5 complete → Badge still shows "Finish setup (5/5)" → 
User confused: "Did I not finish?"
```

### Proposed Fix

Hide the setup prompt when all items are complete.

```tsx
// In PlanScreen.tsx or wherever SetupChecklist renders

const isSetupComplete = setupItems.every(item => 
  item.completed || item.notApplicable
);

// Only render if incomplete
{!isSetupComplete && (
  <SetupChecklistPrompt 
    completed={completedCount} 
    total={totalCount} 
  />
)}
```

### Optional Enhancement

If setup was recently completed (within last 24 hours), show a success state instead:

```
✓ Setup complete — you're ready to go
```

Then hide entirely after 24 hours.

---

## Files to Modify

| File | Issue | Changes |
| --- | --- | --- |
| `src/components/checkin/CheckInConversation.tsx` | #1 | Replace auto-transition with user-controlled close |
| `src/types/habit.ts` | #1 | Add conversation array to CheckIn type |
| `src/components/journey/DayCard.tsx` | #1 | Make expandable to show full conversation |
| `src/components/runtime/PlanScreen.tsx` | #2 | Conditionally hide setup prompt when complete |

---

## Success Criteria

**Issue 1:**

- [ ]  User explicitly closes reflection conversation (not auto-closed)
- [ ]  Full conversation is stored with check-in record
- [ ]  Day cards can expand to show full conversation history
- [ ]  User can browse past reflections from Journey tab

**Issue 2:**

- [ ]  Setup prompt hidden when all items complete
- [ ]  No false "incomplete" signals on any tab